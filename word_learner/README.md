# 拍照学单词

这是一个使用Python和tkinter开发的应用程序，允许用户通过拍照或上传图片来识别图片中的单词，并提供学习功能。

## 功能特点

- **图片获取**：支持拍照或从本地上传图片
- **文字识别**：使用OpenAI API识别图片中的单词
- **单词学习**：提供单词释义、发音和例句
- **单词管理**：支持将单词添加到生词本，进行复习
- **复习系统**：基于间隔重复算法，帮助用户高效记忆单词
- **相册功能**：保存历史图片，方便回顾学习内容

## 安装依赖

```bash
pip install pillow requests opencv-python
```
## 使用方法
1. 配置API密钥：
   
   - 在设置页面中配置您的OpenAI API密钥
2. 拍照识别：
   
   - 点击"拍照"按钮拍摄包含英文单词的图片
   - 或点击"上传图片"按钮从本地选择图片
   - 点击"识别文字"按钮识别图片中的单词
3. 学习单词：
   
   - 从识别结果列表中选择单词
   - 查看单词释义、音标和例句
   - 点击"发音"按钮听取单词发音
   - 点击"添加到生词本"将单词保存到生词本
4. 管理生词本：
   
   - 在生词本页面查看所有保存的单词
   - 支持搜索和排序功能
   - 双击单词查看详情
   - 右键单词可删除或查看详情
5. 复习单词：
   
   - 在复习页面进行单词复习
   - 系统会根据记忆曲线安排复习计划
   - 记录复习进度和正确率
## 项目结构
- app.py ：主应用程序入口
- camera.py ：相机捕获模块
- review.py ：复习管理模块
- words.py ：单词管理模块
- album.py ：相册管理模块
- utils.py ：工具函数模块
## 数据存储
应用程序使用SQLite数据库存储单词和复习记录：

- 单词表：存储单词、释义、例句等信息
- 复习记录表：记录单词复习历史
- 相册表：存储图片路径和相关信息
## 注意事项
- 需要有效的OpenAI API密钥才能使用识别和查询功能
- 首次运行时会自动创建数据库和图片存储目录
- 图片将保存在应用程序目录下的 images 文件夹中

# 拍照学单词应用程序文档

## 项目概述

拍照学单词是一个基于Python和Tkinter开发的桌面应用程序，旨在帮助用户通过拍照识别英文单词并进行学习。该应用程序利用OpenAI的图像识别API从图片中提取英文单词，并提供单词释义、音标和例句等学习资源。

## 系统架构

该应用程序采用模块化设计，主要包含以下几个核心模块：

1. 主应用程序 (`app.py`)
2. API服务 (`api_service.py`)
3. 单词详情管理 (`word_details.py`)
4. 图片管理 (`image_manager.py`)
5. 相册管理 (`album.py`)
6. 复习管理 (`review.py`)
7. 单词管理 (`words.py`)
8. 相机捕获 (`camera.py`)
9. 设置管理 (`settings.py`)
10. 工具函数 (`utils.py`)

## 模块详细说明

### 1. 主应用程序 (`app.py`)

主应用程序是整个系统的核心，负责初始化各个模块并创建用户界面。

**主要功能**：
- 初始化数据库和各个服务模块
- 创建用户界面，包括相机页面、单词本页面、设置页面等
- 处理用户交互和页面切换
- 协调各个模块之间的通信

**主要类**：
- `WordLearnerApp`：应用程序主类，管理整个应用程序的生命周期

### 2. API服务 (`api_service.py`)

API服务模块负责与OpenAI API进行通信，处理图像识别和单词查询请求。

**主要功能**：
- 图像识别：从图片中提取英文单词
- 单词查询：获取单词的释义、音标和例句
- 模拟模式：在没有API密钥的情况下使用模拟数据进行测试

**主要类**：
- `APIService`：API服务类，封装了与OpenAI API的通信逻辑

**主要方法**：
- `recognize_text(image_path)`：识别图片中的文字
- `query_word_details(word)`：查询单词详情
- `set_mock_mode(mock_mode)`：设置是否使用模拟数据
- `set_api_key(api_key)`：设置API密钥

### 3. 单词详情管理 (`word_details.py`)

单词详情管理模块负责管理单词数据，包括添加、删除、查询单词等操作。

**主要功能**：
- 获取生词本中的单词列表
- 获取单词详情（释义、例句等）
- 添加单词到生词本
- 删除单词

**主要类**：
- `WordDetailsManager`：单词详情管理类，封装了单词数据的CRUD操作

**主要方法**：
- `get_wordbook_words(search_term, sort_option)`：获取生词本单词列表
- `get_word_details(word)`：获取单词详情
- `add_word(word, translation, example, image_path)`：添加单词到生词本
- `delete_word(word)`：删除单词

### 4. 图片管理 (`image_manager.py`)

图片管理模块负责处理图片的保存和加载。

**主要功能**：
- 保存图片到指定目录
- 加载图片

**主要类**：
- `ImageManager`：图片管理类，封装了图片操作

**主要方法**：
- `save_image(img, prefix)`：保存图片并返回路径
- `load_image(image_path)`：加载图片

### 5. 相册管理 (`album.py`)

相册管理模块负责管理用户拍摄或上传的图片。

**主要功能**：
- 显示相册中的图片
- 添加图片到相册
- 删除相册中的图片
- 查看图片详情

**主要类**：
- `AlbumManager`：相册管理类，封装了相册相关操作

### 6. 复习管理 (`review.py`)

复习管理模块负责管理用户的单词复习。

**主要功能**：
- 生成复习计划
- 记录复习结果
- 调整复习间隔

**主要类**：
- `ReviewManager`：复习管理类，封装了复习相关操作

### 7. 单词管理 (`words.py`)

单词管理模块负责管理用户的单词学习。

**主要功能**：
- 显示单词列表
- 添加单词
- 删除单词
- 查看单词详情

**主要类**：
- `WordsManager`：单词管理类，封装了单词学习相关操作

### 8. 相机捕获 (`camera.py`)

相机捕获模块负责处理相机拍照功能。

**主要功能**：
- 打开相机
- 拍照
- 处理拍摄的图片

**主要类**：
- `CameraCapture`：相机捕获类，封装了相机操作

### 9. 设置管理 (`settings.py`)

设置管理模块负责管理应用程序的设置。

**主要功能**：
- 加载设置
- 保存设置
- 根据英语等级筛选单词

**主要类**：
- `SettingsManager`：设置管理类，封装了设置相关操作

**主要方法**：
- `load_settings()`：从数据库加载设置
- `save_settings()`：保存设置到数据库
- `filter_words_by_level(words)`：根据英语等级筛选单词

### 10. 工具函数 (`utils.py`)

工具函数模块提供了一些通用的工具函数。

**主要功能**：
- 调整图片大小
- 发音单词
- 打开在线词典

**主要函数**：
- `resize_image(img, width, height)`：调整图片大小
- `pronounce_word(word)`：发音单词
- `open_online_dictionary(word)`：打开在线词典

## 数据库结构

应用程序使用SQLite数据库存储数据，主要包含以下几个表：

### 1. 单词表 (`words`)

存储用户添加的单词信息。

**字段**：
- `id`：主键，自增
- `word`：单词
- `translation`：翻译
- `example`：例句
- `image_path`：图片路径
- `added_date`：添加日期
- `review_count`：复习次数
- `last_review_date`：最后复习日期
- `next_review_date`：下次复习日期
- `review_interval`：复习间隔

### 2. 复习记录表 (`review_records`)

存储用户的复习记录。

**字段**：
- `id`：主键，自增
- `word_id`：单词ID，外键
- `review_date`：复习日期
- `status`：复习状态

### 3. 相册表 (`album`)

存储用户的图片信息。

**字段**：
- `id`：主键，自增
- `image_path`：图片路径
- `added_date`：添加日期
- `has_words`：是否包含单词

### 4. 设置表 (`settings`)

存储应用程序的设置信息。

**字段**：
- `key`：设置键
- `value`：设置值

## 测试

应用程序提供了两种测试方式：

### 1. 单元测试 (`test_app.py`)

单元测试文件包含了对各个模块的测试用例，可以验证各个模块的功能是否正常。

**主要测试类**：
- `TestWordDetailsManager`：测试单词详情管理类
- `TestImageManager`：测试图片管理类
- `TestAPIService`：测试API服务类

### 2. 测试运行 (`test_run.py`)

测试运行文件提供了一个简化版的应用程序，可以在没有API密钥的情况下使用模拟数据进行测试。

**主要功能**：
- 初始化测试数据库
- 启动应用程序的测试版本
- 设置API服务为模拟模式

## 开发指南

### 添加新功能

1. **添加新模块**：
   - 创建新的Python文件
   - 实现相关功能
   - 在主应用程序中导入并初始化

2. **扩展现有模块**：
   - 在相应的模块文件中添加新的类或方法
   - 更新主应用程序中的相关代码

3. **修改用户界面**：
   - 在主应用程序的`create_ui`方法中添加新的UI元素
   - 实现相应的事件处理函数

### 调试技巧

1. **使用模拟模式**：
   - 设置API服务为模拟模式：`api_service.set_mock_mode(True)`
   - 使用模拟数据进行测试

2. **运行单元测试**：
   - 运行特定的测试类：`python -m unittest test_app.TestAPIService`
   - 运行所有测试：`python -m unittest test_app`

3. **日志记录**：
   - 在关键位置添加`print`语句或使用Python的`logging`模块记录日志
   - 检查控制台输出以定位问题

## 部署

应用程序可以通过以下方式部署：

1. **直接运行**：
   - 安装所需的Python包：`pip install -r requirements.txt`
   - 运行主应用程序：`python app.py`

2. **打包为可执行文件**：
   - 使用PyInstaller打包：`pyinstaller --onefile --windowed app.py`
   - 分发生成的可执行文件

## 未来改进方向

1. **支持更多语言**：
   - 添加多语言支持
   - 实现语言切换功能

2. **改进单词识别算法**：
   - 使用更先进的图像识别技术
   - 提高识别准确率

3. **添加更多学习功能**：
   - 单词测验
   - 学习进度统计
   - 个性化学习计划

4. **优化用户界面**：
   - 改进UI设计
   - 添加更多交互效果
   - 支持主题切换

5. **添加云同步功能**：
   - 实现数据云备份
   - 支持多设备同步

## 结语

拍照学单词应用程序是一个功能丰富的英语学习工具，通过模块化设计和清晰的代码结构，为开发者提供了良好的扩展性。
希望本文档能够帮助开发者更好地理解和扩展这个应用程序。